(this["webpackJsonp@mikecodeur/react-hooks-avances"]=this["webpackJsonp@mikecodeur/react-hooks-avances"]||[]).push([[37],{245:function(n,a,e){"use strict";e.r(a),e.d(a,"readingTime",(function(){return o})),e.d(a,"default",(function(){return l})),e.d(a,"tableOfContents",(function(){return u})),e.d(a,"frontMatter",(function(){return r}));var s=e(84),t=(e(0),e(328)),p=["components"],o={text:"3 min read",minutes:2.4,time:144e3,words:480},c={};function l(n){var a=n.components,e=Object(s.a)(n,p);return Object(t.a)("wrapper",Object.assign({},c,e,{components:a,mdxType:"MDXLayout"}),Object(t.a)("h1",{id:"usecallback"},"useCallBack"),Object(t.a)("h3",{id:"-comprendre-usecallback"},"\ud83d\udca1 Comprendre useCallBack"),Object(t.a)("h2",{id:"-tes-notes"},"\ud83d\udcdd Tes notes"),Object(t.a)("p",null,"Detaille ce que tu as appris ici\n",Object(t.a)("inlineCode",{parentName:"p"},"src/exercise/03.md"),"ou\xa0sur\xa0une\xa0page\xa0",Object(t.a)("a",{parentName:"p",href:"https://go.mikecodeur.com/course-notes-template"},"Notion")),Object(t.a)("h2",{id:"comprendre"},"Comprendre"),Object(t.a)("p",null,Object(t.a)("inlineCode",{parentName:"p"},"useCallBack")," renvoie une fonction\n",Object(t.a)("a",{parentName:"p",href:"https://fr.wikipedia.org/wiki/M%C3%A9mo%C3%AFsation"},"m\xe9mo\xefs\xe9"),", c\u2019est \xe0 dire\nstock\xe9e en m\xe9moire. Un nouvel version de la fonction sera retourn\xe9e si une des\nentr\xe9es change (d\xe9pendances du hook). Dans l\u2019exemple ci dessous, la fonction\n",Object(t.a)("inlineCode",{parentName:"p"},"handleClick")," est toujours la m\xeame r\xe9f\xe9rence (ce qui optimise les performances)\nsans ",Object(t.a)("inlineCode",{parentName:"p"},"useCallback"),", un nouvelle version serait cr\xe9\xe9 \xe0 chaque ",Object(t.a)("inlineCode",{parentName:"p"},"render"),"."),Object(t.a)("pre",null,Object(t.a)("code",{parentName:"pre",className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> handleClick <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// handle the click event</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyChild</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n'}})),Object(t.a)("p",null,"\ud83d\udcd1 Le lien vers la\n",Object(t.a)("a",{parentName:"p",href:"https://fr.reactjs.org/docs/hooks-reference.html#usecallback"},"useCallback")),Object(t.a)("h2",{id:"exercice"},"Exercice"),Object(t.a)("p",null,"Dans cet exercice tu vas devoir optimiser les hooks ",Object(t.a)("inlineCode",{parentName:"p"},"useFindMarvelList")," et\n",Object(t.a)("inlineCode",{parentName:"p"},"useFindMarvelByName")," avec ",Object(t.a)("inlineCode",{parentName:"p"},"useCallBack"),". Mais juste avant modifions\n",Object(t.a)("inlineCode",{parentName:"p"},"useFetchData")," en extrayant le terme de recheche : ",Object(t.a)("inlineCode",{parentName:"p"},"search")," que nous allons\nd\xe9placer dans le ",Object(t.a)("inlineCode",{parentName:"p"},"useCallback.")),Object(t.a)("blockquote",null,Object(t.a)("p",{parentName:"blockquote"},Object(t.a)("em",{parentName:"p"},"Le param ",Object(t.a)("inlineCode",{parentName:"em"},"search")," a disparu car il sera contenu dans callback. callback sera\nune fonction m\xe9mo\xefs\xe9 issue de ",Object(t.a)("inlineCode",{parentName:"em"},"useCallback")," qui retourne une Promise :\n",Object(t.a)("inlineCode",{parentName:"em"},"fetchMarvel(marvelName)")))),Object(t.a)("pre",null,Object(t.a)("code",{parentName:"pre",className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token keyword">function</span> <span class="token function">useFetchData</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    data<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n    error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n    status<span class="token operator">:</span> <span class="token string">\'idle\'</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>promise<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">\'fetching\'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    promise\n      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">marvel</span> <span class="token operator">=></span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">\'done\'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> marvel<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=></span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">\'fail\'</span><span class="token punctuation">,</span> error<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>callback<span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n  <span class="token keyword">return</span> state\n<span class="token punctuation">}</span>\n'}})),Object(t.a)("h3",{id:"1--retourner-un-callback"},"1 \ud83d\ude80 Retourner un callback"),Object(t.a)("p",null,"Au lieu d\u2019avoir a g\xe9rer de nombreuses fois le ",Object(t.a)("inlineCode",{parentName:"p"},"useCallback")," dans les hooks\nsp\xe9cifiques (",Object(t.a)("inlineCode",{parentName:"p"},"useFindMarvelList")," et ",Object(t.a)("inlineCode",{parentName:"p"},"useFindMarvelByName"),"), et ex\xe9cuter les\nappels de fonctions dans ",Object(t.a)("inlineCode",{parentName:"p"},"useFetchData"),", nous voudrions faire l\u2019inverse. C\u2019est a\ndire ex\xe9cuter les fonctions dans les hooks sp\xe9cifiques et que la m\xe9mo\xefsation via\n",Object(t.a)("inlineCode",{parentName:"p"},"useCallback")," se fasse au niveau de ",Object(t.a)("inlineCode",{parentName:"p"},"useFetchData"),". ",Object(t.a)("em",{parentName:"p"},"Au passage il faudra\nd\xe9placer le ",Object(t.a)("inlineCode",{parentName:"em"},"useEffect")," dans les hooks sp\xe9cifiques.")),Object(t.a)("p",null,"Nous allons donc maintenant retourner un ",Object(t.a)("inlineCode",{parentName:"p"},"callback")," de ",Object(t.a)("inlineCode",{parentName:"p"},"useFetchData")," (que l\u2019on\nva appeler ",Object(t.a)("inlineCode",{parentName:"p"},"execute"),") qui sera appel\xe9 sur le ",Object(t.a)("inlineCode",{parentName:"p"},"useEffect")," des hooks sp\xe9cifiques\ncomme ceci."),Object(t.a)("pre",null,Object(t.a)("code",{parentName:"pre",className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token keyword">function</span> <span class="token function">useFindMarvelList</span><span class="token punctuation">(</span><span class="token parameter">marvelName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span>  <span class="token punctuation">{</span>data<span class="token punctuation">,</span> error<span class="token punctuation">,</span> status<span class="token punctuation">,</span> execute<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>marvelName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">execute</span><span class="token punctuation">(</span><span class="token function">fetchMarvelsList</span><span class="token punctuation">(</span>marvelName<span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>marvelName<span class="token punctuation">,</span>execute<span class="token punctuation">]</span><span class="token punctuation">)</span>\n  <span class="token keyword">return</span> <span class="token punctuation">{</span>data<span class="token punctuation">,</span> error<span class="token punctuation">,</span> status<span class="token punctuation">}</span>\n'}})),Object(t.a)("p",null,"Dans cet exercice tu vas devoir modifier ",Object(t.a)("inlineCode",{parentName:"p"},"useFetchData")," en retournant un\ncallback que l\u2019on va nommer ",Object(t.a)("inlineCode",{parentName:"p"},"execute")," qui permet d\u2019ex\xe9cuter le ",Object(t.a)("inlineCode",{parentName:"p"},"fetch"),"."),Object(t.a)("pre",null,Object(t.a)("code",{parentName:"pre",className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token function">execute</span><span class="token punctuation">(</span><span class="token function">fetchMarvelsList</span><span class="token punctuation">(</span>marvelName<span class="token punctuation">)</span><span class="token punctuation">)</span>\n'}})),Object(t.a)("h2",{id:"-pour-aller-plus-loin"},"\ud83d\ude80 Pour aller plus loin"),Object(t.a)("p",null,"Le hook ",Object(t.a)("inlineCode",{parentName:"p"},"useMemo")," est proche : Les deux hooks ont la signature suivante:"),Object(t.a)("pre",null,Object(t.a)("code",{parentName:"pre",className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token function">useCallback</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> deps<span class="token punctuation">)</span>\n<span class="token function">useMemo</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> deps<span class="token punctuation">)</span>\n'}})),Object(t.a)("p",null,"Tous deux prennent une fonction en param\xe8tre et un tableau de d\xe9pendances. La\ndiff\xe9rence est que :"),Object(t.a)("ul",null,Object(t.a)("li",{parentName:"ul"},Object(t.a)("inlineCode",{parentName:"li"},"useCallback")," n\u2019appelle pas la fonction et retourne la fonction m\xe9mo\xefs\xe9e."),Object(t.a)("li",{parentName:"ul"},Object(t.a)("inlineCode",{parentName:"li"},"useMemo")," ex\xe9cute la fonction et retourne le r\xe9sultat m\xe9mo\xefs\xe9")),Object(t.a)("pre",null,Object(t.a)("code",{parentName:"pre",className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token string">\'bar\'</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> memoizedCallback <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> memoizedResult <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\nmemoizedCallback\n<span class="token comment">// \u0192 foo() {</span>\n<span class="token comment">//   return \'bar\';</span>\n<span class="token comment">// }</span>\nmemoizedResult <span class="token comment">// \'bar\'</span>\n<span class="token function">memoizedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \'bar\'</span>\n<span class="token function">memoizedResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \ud83d\udd34 TypeError</span>\n'}})),Object(t.a)("p",null,"Doc du ",Object(t.a)("a",{parentName:"p",href:"https://fr.reactjs.org/docs/hooks-reference.html#usememo"},"hook useMemo")),Object(t.a)("h2",{id:"-feedback"},"\ud83d\udc1c Feedback"),Object(t.a)("p",null,"Remplir le formulaire le\n",Object(t.a)("a",{parentName:"p",href:"https://go.mikecodeur.com/cours-react-avis?entry.1430994900=React%20Hooks%20Avanc%C3%A9s&entry.533578441=03%20useCallBack"},"formulaire de FeedBack.")))}l.isMDXComponent=!0;var u=function(){return[{id:"-comprendre-usecallback",level:3,title:"\ud83d\udca1 Comprendre useCallBack",children:[]},{id:"-tes-notes",level:2,title:"\ud83d\udcdd Tes notes",children:[]},{id:"comprendre",level:2,title:"Comprendre",children:[]},{id:"exercice",level:2,title:"Exercice",children:[{id:"1--retourner-un-callback",level:3,title:"1 \ud83d\ude80 Retourner un callback",children:[]}]},{id:"-pour-aller-plus-loin",level:2,title:"\ud83d\ude80 Pour aller plus loin",children:[]},{id:"-feedback",level:2,title:"\ud83d\udc1c Feedback",children:[]}]},r={}},328:function(n,a,e){"use strict";e.d(a,"a",(function(){return d}));var s=e(0),t=e.n(s);function p(n,a,e){return a in n?Object.defineProperty(n,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[a]=e,n}function o(n,a){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);a&&(s=s.filter((function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),e.push.apply(e,s)}return e}function c(n){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?o(Object(e),!0).forEach((function(a){p(n,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(e,a))}))}return n}function l(n,a){if(null==n)return{};var e,s,t=function(n,a){if(null==n)return{};var e,s,t={},p=Object.keys(n);for(s=0;s<p.length;s++)e=p[s],a.indexOf(e)>=0||(t[e]=n[e]);return t}(n,a);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(n);for(s=0;s<p.length;s++)e=p[s],a.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(t[e]=n[e])}return t}var u=t.a.createContext({}),r=function(n){var a=t.a.useContext(u),e=a;return n&&(e="function"===typeof n?n(a):c(c({},a),n)),e},i={inlineCode:"code",wrapper:function(n){var a=n.children;return t.a.createElement(t.a.Fragment,{},a)}},k=t.a.forwardRef((function(n,a){var e=n.components,s=n.mdxType,p=n.originalType,o=n.parentName,u=l(n,["components","mdxType","originalType","parentName"]),k=r(e),d=s,m=k["".concat(o,".").concat(d)]||k[d]||i[d]||p;return e?t.a.createElement(m,c(c({ref:a},u),{},{components:e})):t.a.createElement(m,c({ref:a},u))}));function d(n,a){var e=arguments,s=a&&a.mdxType;if("string"===typeof n||s){var p=e.length,o=new Array(p);o[0]=k;var c={};for(var l in a)hasOwnProperty.call(a,l)&&(c[l]=a[l]);c.originalType=n,c.mdxType="string"===typeof n?n:s,o[1]=c;for(var u=2;u<p;u++)o[u]=e[u];return t.a.createElement.apply(null,o)}return t.a.createElement.apply(null,e)}k.displayName="MDXCreateElement"}}]);
//# sourceMappingURL=37.55251903.chunk.js.map